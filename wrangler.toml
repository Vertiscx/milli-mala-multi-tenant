name = "milli-mala"
main = "src/worker.js"
compatibility_date = "2024-09-23"

# Use Node.js compatibility for better package support
compatibility_flags = [ "nodejs_compat" ]

# Environment variables (use wrangler secret for sensitive values)
[vars]
PORT = "8080"
LOG_LEVEL = "info"
PDF_LOCALE = "is-IS"
PDF_INCLUDE_INTERNAL_NOTES = "false"
PDF_INCLUDE_ATTACHMENTS_LIST = "true"
PDF_COMPANY_NAME = "Samgöngustofa"

# KV namespace for audit logs
[[kv_namespaces]]
binding = "AUDIT_LOG"
id = "f74b8a25228b4d719cfc1e004f17d097"

# Secrets (set these with: wrangler secret put <NAME>)
# wrangler secret put ZENDESK_SUBDOMAIN
# wrangler secret put ZENDESK_EMAIL
# wrangler secret put ZENDESK_API_TOKEN
# wrangler secret put ZENDESK_WEBHOOK_SECRET
# wrangler secret put ONESYSTEMS_BASE_URL
# wrangler secret put ONESYSTEMS_APP_KEY
# wrangler secret put AUDIT_SECRET
# wrangler secret put MALASKRA_API_KEY

# ============================================
# STAGING ENVIRONMENT
# ============================================
# Deploy:  wrangler deploy --env staging
# Logs:    wrangler tail --env staging
# Secrets: wrangler secret put <NAME> --env staging
[env.staging]
name = "milli-mala-staging"

[env.staging.vars]
PORT = "8080"
LOG_LEVEL = "debug"
PDF_LOCALE = "is-IS"
PDF_INCLUDE_INTERNAL_NOTES = "false"
PDF_INCLUDE_ATTACHMENTS_LIST = "true"
PDF_COMPANY_NAME = "Samgöngustofa"

[[env.staging.kv_namespaces]]
binding = "AUDIT_LOG"
id = "b4779d850432478aa656cb68559a71f2"

# ============================================
# GOPRO ENVIRONMENT
# ============================================
# Deploy:  wrangler deploy --env gopro
# Logs:    wrangler tail --env gopro
# Secrets: wrangler secret put <NAME> --env gopro
[env.gopro]
name = "milli-mala-gopro"

[env.gopro.vars]
PORT = "8080"
LOG_LEVEL = "debug"
DOC_SYSTEM = "gopro"
PDF_LOCALE = "is-IS"
PDF_INCLUDE_INTERNAL_NOTES = "false"
PDF_INCLUDE_ATTACHMENTS_LIST = "true"
PDF_COMPANY_NAME = "Samgöngustofa"

[[env.gopro.kv_namespaces]]
binding = "AUDIT_LOG"
id = "1e5225eaae814821bd77fa5b70222f0e"
